<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Moderator Dashboard â€“ GuessWho Stereotype</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>

<body>
    <header>
        <img src="{{ url_for('static', filename='logo.png') }}" alt="Logo" style="height:80px;">
    </header>

    <main class="dashboard-main">
        <h2>Moderator Dashboard</h2>
        <p>Choose how you want to run the game:</p>

        <div style="margin: 30px 0; display: flex; gap: 20px; justify-content: center; flex-wrap: wrap;">
            <div style="background: white; padding: 30px; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); max-width: 400px;">
                <h3>ğŸ® Controlled Entry Mode (Recommended)</h3>
                <p style="text-align: left; color: #666;">
                    Use the control panel to manage participant entry with a static join URL. 
                    Perfect for controlled research sessions with sequential participant pairs.
                </p>
                <a href="/moderator/control" class="link-btn" style="display: inline-block; margin-top: 15px;">
                    Open Control Panel
                </a>
            </div>

            <div style="background: white; padding: 30px; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); max-width: 400px;">
                <h3>ğŸ² Quick Game Mode</h3>
                <p style="text-align: left; color: #666;">
                    Create a game instantly with pre-generated URLs. 
                    Use this for quick testing or when you need immediate access.
                </p>
                <button id="start-btn" class="primary-btn" style="margin-top: 15px;">
                    Create Quick Game
                </button>
            </div>
        </div>

        <div id="links" class="dashboard-links"></div>

        <div class="footer">
            <p>You are logged in as <strong>Moderator</strong>.</p>
            <form action="/logout" method="get">
                <button type="submit">ğŸ”’ Logout</button>
            </form>
        </div>
    </main>

    <script>
        document.getElementById('start-btn').onclick = async () => {
            const res = await fetch('/create_game', {method: 'POST'});
            const data = await res.json();
            if (data.status === 'ok') {
                const gid = data.game_id;
                const p1_id = data.participant_ids.player1;
                const p2_id = data.participant_ids.player2;
                const mod_id = data.participant_ids.moderator;
                document.getElementById('links').innerHTML = `
                    <h3>ğŸ†• New Game Created</h3>
                    <p><b>Game ID:</b> <span class="game-id">${gid}</span></p>
                    <div class="link-group">
                        <a class="link-btn" href="/player1?game_id=${gid}&participant_id=${p1_id}" target="_blank">ğŸ­ Open Player 1 (Secret Card)</a>
                        <a class="link-btn" href="/player2?game_id=${gid}&participant_id=${p2_id}" target="_blank">ğŸ” Open Player 2 (Guesser)</a>
                        <a class="link-btn" href="/moderator?game_id=${gid}&participant_id=${mod_id}" target="_blank">ğŸ–¥ï¸ Open Moderator View (Live)</a>
                    </div>
                `;
            } else {
                alert('Failed to create game.');
            }
        };
    </script>
</body>

</html>